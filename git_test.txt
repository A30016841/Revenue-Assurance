SELECT 
TO_DATE(D.ERDAT) AS "Invoicing Date", 
TO_DATE(D.DRUCKDAT) AS Print_Date,
CASE WHEN ZZ_DISP_CTRL = 'APAP' THEN 'Paper Bill'
WHEN ZZ_DISP_CTRL = 'AWEB' THEN 'E-Bill'
WHEN ZZ_DISP_CTRL = 'ABPV' THEN 'BPay'
ELSE 'Other'
END AS "Shipping Control", 
V.SPARTE,
CASE WHEN V.BEGRU = 'ZCNI' THEN 'C&I' ELSE 'MASS MARKET' END AS ACCOUNT_CLASS,
COUNT(*)
FROM COMMERCIAL.ERDK D
JOIN COMMERCIAL.EVER V
ON D.ZZ_VERTRAG = V.VERTRAG
JOIN CUSTOMER.FKKVKP F
ON V.VKONTO = F.VKONT
WHERE TO_DATE(D.ERDAT) >= ADD_DAYS(CURRENT_DATE, -30)
AND D.ERDAT = '20190402'
AND D.STOKZ = '' 
AND D.SIMULATED = ''
GROUP BY
TO_DATE(D.ERDAT), 
TO_DATE(D.DRUCKDAT),
CASE WHEN ZZ_DISP_CTRL = 'APAP' THEN 'Paper Bill'
WHEN ZZ_DISP_CTRL = 'AWEB' THEN 'E-Bill'
WHEN ZZ_DISP_CTRL = 'ABPV' THEN 'BPay'
ELSE 'Other'
END, 
V.SPARTE,
CASE WHEN V.BEGRU = 'ZCNI' THEN 'C&I' ELSE 'MASS MARKET' END